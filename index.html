<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Cyberdeck Config Helper (SR5)</title>
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 1em; max-width: 500px; }
    label { display: block; margin-top: 1em; }
    input[type="number"] { width: 50px; }
    button { margin-top: 1.5em; }
    #status { margin-top: 1em; color: green; }
  </style>
</head>
<body>

  <h2>Cyberdeck Configuration</h2>

  <form id="deck-config">
    <label>
      Load Preset:
      <select id="preset-selector">
        <option value="">-- Select a preset --</option>
      </select>
    </label>

    <label>Attack: <input type="number" name="attack" min="0" max="8"></label>
    <label>Sleaze: <input type="number" name="sleaze" min="0" max="8"></label>
    <label>Data Processing: <input type="number" name="dataProcessing" min="0" max="8"></label>
    <label>Firewall: <input type="number" name="firewall" min="0" max="8"></label>

    <button type="submit">Save Configuration</button>
    <button type="button" id="reset-config">Reset</button>
  </form>

  <div id="status"></div>

  <script>
    const STORAGE_KEY = "cyberdeckConfig";

    // Load saved config from localStorage
    function loadConfig() {
      const saved = JSON.parse(localStorage.getItem(STORAGE_KEY));
      if (saved) {
        for (const key in saved) {
          $(`[name="${key}"]`).val(saved[key]);
        }
      }
    }

    // Save config to localStorage
    function saveConfig() {
      const config = {
        attack: parseInt($('[name="attack"]').val()) || 0,
        sleaze: parseInt($('[name="sleaze"]').val()) || 0,
        dataProcessing: parseInt($('[name="dataProcessing"]').val()) || 0,
        firewall: parseInt($('[name="firewall"]').val()) || 0,
      };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(config));
      $("#status").text("Configuration saved!");
    }

    // Reset config
    function resetConfig() {
      localStorage.removeItem(STORAGE_KEY);
      $("#deck-config")[0].reset();
      $("#status").text("Configuration reset.");
    }

    // Load presets from external JSON file
    function loadPresets() {
      $.getJSON("presets.json", function (presets) {
        presets.forEach((preset, index) => {
          $("#preset-selector").append(
            $("<option>")
              .val(index)
              .text(preset.name)
              .data("config", preset)
          );
        });
      });
    }

    // Handle preset selection
    $("#preset-selector").on("change", function () {
      const selected = $(this).find("option:selected").data("config");
      if (selected) {
        for (const key in selected) {
          if (key !== "name") {
            $(`[name="${key}"]`).val(selected[key]);
          }
        }
        $("#status").text(`Preset "${selected.name}" loaded.`);
      }
    });

    $(document).ready(function () {
      loadConfig();
      loadPresets();
      $("#deck-config").on("submit", function (e) {
        e.preventDefault();
        saveConfig();
      });
      $("#reset-config").on("click", function () {
        resetConfig();
      });
    });
  </script>

</body>
</html>

